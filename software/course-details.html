<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <link rel="icon" type="image/png" href="favicon.png">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تفاصيل المادة - Software Learn</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="1.index.css">
    <link rel="icon" type="image/png" href="logo tab.png"><script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
</head>
<body>
    <div class="cursor"></div>
    <div class="aurora-background"></div>
    <div id="page-overlay" class="page-overlay"></div>

    <div class="page-container">
        <aside id="sidebar" class="sidebar glass">
            <div class="sidebar-header">
                <h3><i class="bi bi-code-slash"></i> Software Learn</h3>
                <button id="close-sidebar-btn" class="close-sidebar-btn">&times;</button>
            </div>
            <nav id="main-nav">
                                <a href="../index.html">الصفحة الرئيسية للقسم</a>

                    <a href="index.html">الصفحة الرئيسية للتخصص</a>
                <a href="courses.html" class="active">المواد الدراسية</a>
                <a href="gpa.html">حساب المعدل</a>
                <a href="teachers.html">الهيئة التدريسية</a>
                <a href="about-software.html">عن التخصص </a>
                <a href="about-web.html">عن الموقع</a>
            </nav>
        </aside>

        <div class="main-content">
            <header class="mobile-header glass">
                <button id="hamburger-btn" class="hamburger-btn">
                    <span></span><span></span><span></span>
                </button>
                <h2 class="mobile-logo"><i class="bi bi-code-slash"></i> Software Learn</h2>
            </header>
            
            <main id="course-main-content">
                </main>
        </div>
    </div> 

    <script src="courses-data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = document.getElementById('course-main-content');
            const urlParams = new URLSearchParams(window.location.search);
            const courseId = urlParams.get('course');

            if (courseId && coursesData[courseId]) {
                const course = coursesData[courseId];
                document.title = `${course.title} - Software Learn`;

                let resourcesHTML = '';

                // 1. Build Files section
                if (course.resources.files && course.resources.files.length > 0) {
                    resourcesHTML += `<div class="resources-section glass"><h3><i class="bi bi-archive-fill"></i> ملخصات وملفات</h3><ul>`;
                    course.resources.files.forEach(file => {
                        resourcesHTML += `<li><a href="${file.url}" target="_blank"><span>${file.title}</span><span class="link-arrow"><i class="bi bi-box-arrow-up-left"></i></span></a></li>`;
                    });
                    resourcesHTML += `</ul></div>`;
                }
                
                // 2. Build Slides section
                if (course.resources.slides && course.resources.slides.length > 0) {
                    resourcesHTML += `<div class="resources-section glass"><h3><i class="bi bi-file-earmark-slides-fill"></i> سلايدات وشروحات</h3><ul>`;
                    course.resources.slides.forEach(slide => {
                        resourcesHTML += `<li><a href="${slide.url}" target="_blank"><span>${slide.title}</span><span class="link-arrow"><i class="bi bi-box-arrow-up-left"></i></span></a></li>`;
                    });
                    resourcesHTML += `</ul></div>`;
                }

                // 3. ✨ Build Exam Questions section
                if (course.resources.examQuestions && course.resources.examQuestions.length > 0) {
                    resourcesHTML += `<div class="resources-section glass"><h3><i class="bi bi-file-earmark-text-fill"></i> أسئلة سنوات</h3><ul>`;
                    course.resources.examQuestions.forEach(file => {
                        resourcesHTML += `<li><a href="${file.url}" target="_blank"><span>${file.title}</span><span class="link-arrow"><i class="bi bi-box-arrow-up-left"></i></span></a></li>`;
                    });
                    resourcesHTML += `</ul></div>`;
                }
                
                // 4. Build Videos section
                if (course.resources.videos && course.resources.videos.length > 0) {
                    resourcesHTML += `<div class="resources-section glass"><h3><i class="bi bi-youtube"></i> فيديوهات مساعدة</h3>`;
                    resourcesHTML += `<div class="video-grid">`;
                    course.resources.videos.forEach(video => {
                        resourcesHTML += `
                            <div class="video-item">
                                <h4 class="video-title">${video.title}</h4>
                                <div class="video-container">
                                    <iframe src="${video.url}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                                </div>
                            </div>
                        `;
                    });
                    resourcesHTML += `</div></div>`;
                }

                mainContent.innerHTML = ` 
                    <div class="main-page-header fade-in">
                        <h1><i class="bi bi-book-fill"></i> ${course.title} (${course.code})</h1>
                        <p>${course.creditHours}</p>
                    </div>

                    <div class="meta-box-container fade-in">
                        <div class="meta-box glass">
                            <i class="bi bi-hash"></i>
                            <span>رقم السطر</span>
                            <strong>${course.lineNumber}</strong>
                        </div>
                        <div class="meta-box glass">
                            <i class="bi bi-display-fill"></i>
                            <span>آلية التدريس</span>
                            <strong>${course.teachingMethod || 'غير محدد'}</strong>
                        </div>
                        <div class="meta-box glass">
                            <i class="bi bi-bank2"></i>
                            <span>الكلية</span>
                            <strong>${course.faculty}</strong>
                        </div>
                        <div class="meta-box glass">
                            <i class="bi bi-building"></i>
                            <span>القسم</span>
                            <strong>${course.department}</strong>
                        </div>
                    </div>

                    <a href="${course.universityLink}" class="gpa-btn course-info-btn" target="_blank"><i class="bi bi-link-45deg"></i> وصف المادة في موقع الجامعة</a>

                    <div class="course-details fade-in">
                        <div class="resources-section glass">
                            <h3><i class="bi bi-sliders"></i> وصف المادة</h3>
                            <p>${course.description}</p>
                        </div>
                        ${resourcesHTML}
                    </div>
                `;
                
                // ✨ --- Start: Add WhatsApp Button Code ---
                if (course.resources.whatsappLink) {
                    // Create the button element
                    const whatsappBtn = document.createElement('a');
                    whatsappBtn.href = course.resources.whatsappLink;
                    whatsappBtn.target = '_blank'; 
                    whatsappBtn.className = 'gpa-btn course-info-btn whatsapp-btn'; 
                    whatsappBtn.innerHTML = `<i class="bi bi-whatsapp"></i> الانضمام لقروب المادة`;

                    // Find the university link button and insert the WhatsApp button before it
                    const universityLinkBtn = mainContent.querySelector('.course-info-btn');
                    if (universityLinkBtn) {
                        universityLinkBtn.parentNode.insertBefore(whatsappBtn, universityLinkBtn);
                    }
                }
                // ✨ --- End: Add WhatsApp Button Code ---
            } else {
                mainContent.innerHTML = `
                    <div class="main-page-header fade-in">
                        <h1><i class="bi bi-exclamation-triangle-fill"></i> خطأ</h1>
                        <p>لم يتم العثور على المادة المطلوبة. الرجاء التأكد من الرابط.</p>
                    </div>
                `;
            }
        });
    </script>
    <script src="course-details.html"></script>
    <script src="script.js"></script>
    
    <script>
        window.addEventListener('unload', function() {
        });
    </script>
</body>
</html>